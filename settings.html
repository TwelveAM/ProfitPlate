<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Settings - ProfitPlate</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¥—</text></svg>">
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>

<nav class="navbar">
    <div class="nav-brand">ðŸ¥— ProfitPlate</div>
    <div class="nav-links">
        <a href="index.html">Dashboard</a>
        <a href="purchases.html">Ingredients</a>
        <a href="recipes.html">Recipes</a>
        <a href="settings.html" class="active">Settings</a>
    </div>
</nav>

<div class="container">
    <h1>Settings</h1>
    
    <div class="card">
        <form id="settings-form">
            <div class="form-group">
                <label>Currency Symbol</label>
                <select id="currency">
                    <option value="EUR">EUR (â‚¬)</option>
                    <option value="USD">USD ($)</option>
                    <option value="GBP">GBP (Â£)</option>
                    <option value="RON">RON (lei)</option>
                </select>
            </div>

            <div class="form-group">
                <label>Number Format (Locale)</label>
                <select id="locale">
                    <option value="eu">European (1.234,56)</option>
                    <option value="us">US/UK (1,234.56)</option>
                </select>
            </div>

            <div class="form-group">
                <label>Calculation Mode</label>
                <div class="toggle-wrapper">
                    <input type="checkbox" id="autoRecalc">
                    <span>Auto-update recipe costs when ingredient prices change</span>
                </div>
                <p class="text-muted small">
                    If unchecked, recipe costs are "frozen" at the moment you created the recipe.
                </p>
            </div>

            <div class="form-group">
                <label>Recipe View</label>
                <div class="toggle-wrapper">
                    <input type="checkbox" id="showAdvanced">
                    <span>Show advanced details (margins, full breakdown) on cards</span>
                </div>
            </div>

            <button type="submit" class="btn-primary">Save Settings</button>
        </form>
    </div>

    <div class="card" style="border-left: 5px solid var(--danger);">
        <h3>Data Management</h3>
        <p>Your data is stored locally in your browser.</p>
        <button class="btn-danger" id="clear-data-btn">Clear All Data</button>
    </div>
</div>

<script src="assets/app.js"></script>
<script>
    // Logic specific to settings page
    document.addEventListener('DOMContentLoaded', () => {
        // Load settings from app.js API
        const settings = window.loadSettings();

        const currencyEl = document.getElementById('currency');
        const localeEl = document.getElementById('locale');
        const autoRecalcEl = document.getElementById('autoRecalc');
        const showAdvancedEl = document.getElementById('showAdvanced');

        if(settings) {
            currencyEl.value = settings.currency || 'EUR';
            localeEl.value = settings.locale || 'eu';
            autoRecalcEl.checked = settings.autoRecalc !== false;
            showAdvancedEl.checked = settings.showAdvanced !== false;
        }

        // Save
        document.getElementById('settings-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const newSettings = {
                currency: currencyEl.value,
                locale: localeEl.value,
                autoRecalc: autoRecalcEl.checked,
                showAdvanced: showAdvancedEl.checked
            };
            window.saveSettings(newSettings);
            alert('Settings saved!');
        });

        // Clear Data
        document.getElementById('clear-data-btn').addEventListener('click', () => {
            if(confirm('Are you sure? This will delete all ingredients and recipes. This cannot be undone.')) {
                localStorage.clear();
                alert('Data cleared.');
                location.reload();
            }
        });
    });
</script>
</body>
</html>
