<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Purchases – ProfitPlate</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <div class="container">
    <header>
      <div style="font-size: 28px; margin-bottom: 4px;">⚖️</div>
      <div style="font-size: 22px; font-weight: 700; letter-spacing: 0.08em;">
        PROFITPLATE
      </div>
      <div style="margin-top: 4px; color: #666;">
        Know your profit per plate.
      </div>
    </header>

    <nav class="nav">
      <a href="index.html" class="nav-link">Home</a>
      <a href="purchases.html" class="nav-link nav-link-active">Purchases</a>
      <a href="recipes.html" class="nav-link">Recipes</a>
      <a href="settings.html" class="nav-link">Settings</a>
    </nav>

    <main>
      <h1>Purchases</h1>
      <p>
        This is your ingredient base. Add items you buy, organize them by
        category, and keep supplier prices up to date. Recipes will use
        everything you add here.
      </p>

      <button type="button" class="btn-primary mt-20" onclick="toggleAddForm()">
        Add item manually
      </button>

      <div id="add-item-form" class="mt-20 hidden">
        <h2>Add a new purchase item</h2>

        <form id="purchase-form">
          <!-- Name -->
          <div class="mt-20">
            <label for="item-name">Name</label>
            <input id="item-name" type="text" required />
          </div>

          <!-- Category + Sub-type -->
          <div class="mt-20">
            <label for="item-category">Category</label>
            <select id="item-category">
              <option value="">Select...</option>
              <option value="Meat & Fish">Meat &amp; Fish</option>
              <option value="Dairy & Eggs">Dairy &amp; Eggs</option>
              <option value="Vegetables & Fruit">Vegetables &amp; Fruit</option>
              <option value="Dry Goods">Dry Goods</option>
              <option value="Spices & Condiments">Spices &amp; Condiments</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="mt-20">
            <label for="item-subtype">Sub-type</label>
            <select id="item-subtype">
              <option value="">Select...</option>
            </select>
          </div>

          <!-- Supplier + Invoice -->
          <div class="mt-20">
            <label for="item-supplier">Supplier</label>
            <input
              id="item-supplier"
              type="text"
              placeholder="Metro, local butcher, dairy, etc."
            />
          </div>

          <div class="mt-20">
            <label for="item-invoice-number">Invoice number</label>
            <input
              id="item-invoice-number"
              type="text"
              placeholder="e.g. 2025-0456 or Ticket #32"
            />
          </div>

          <div class="mt-20">
            <label for="item-invoice-date">Invoice date</label>
            <input id="item-invoice-date" type="date" />
          </div>

          <!-- Unit + base price -->
          <div class="mt-20">
            <label for="item-unit">Unit (for recipes)</label>
            <select id="item-unit">
              <option value="">Select...</option>
              <option value="kg">kg</option>
              <option value="g">gr</option>
              <option value="l">L</option>
              <option value="ml">ml</option>
              <option value="pcs">pcs</option>
            </select>
          </div>

          <div class="mt-20">
            <label for="item-price">Purchase price (per recipe unit)</label>
            <input
              id="item-price"
              type="number"
              step="0.0001"
              inputmode="decimal"
            />
          </div>

          <hr />

          <!-- Pack helper -->
          <section>
            <h3>Or use pack helper</h3>
            <p>
              Example: 100 gr for 5 € → auto-converts price per unit.
            </p>

            <div class="mt-20">
              <label for="pack-qty">Pack quantity</label>
              <input
                id="pack-qty"
                type="number"
                step="0.0001"
                inputmode="decimal"
              />
            </div>

            <div class="mt-20">
              <label for="pack-unit">Pack unit</label>
              <select id="pack-unit">
                <option value="">unit</option>
                <option value="g">gr</option>
                <option value="kg">kg</option>
                <option value="ml">ml</option>
                <option value="l">L</option>
                <option value="pcs">pcs</option>
              </select>
            </div>

            <div class="mt-20">
              <label for="pack-price">Pack price (€)</label>
              <input
                id="pack-price"
                type="number"
                step="0.0001"
                inputmode="decimal"
              />
            </div>

            <div class="mt-20">
              <button
                type="button"
                class="btn-secondary"
                onclick="fillPriceFromPack()"
              >
                Use pack
              </button>
            </div>
          </section>

          <!-- Notes -->
          <div class="mt-20">
            <label for="item-notes">Notes</label>
            <textarea
              id="item-notes"
              rows="3"
              placeholder="Storage info, special notes, etc."
            ></textarea>
          </div>

          <!-- Price history -->
          <section id="price-history-block" class="mt-20 hidden">
            <h3>Price history</h3>
            <p>Last 10 recorded price changes for this ingredient (newest first).</p>

            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Price / unit</th>
                </tr>
              </thead>
              <tbody id="price-history-body"></tbody>
            </table>
          </section>

          <!-- Actions -->
          <div class="mt-20" style="display: flex; gap: 10px;">
            <button
              type="button"
              class="btn-secondary"
              onclick="toggleAddForm()"
            >
              Cancel
            </button>
            <button type="submit" class="btn-primary">Save item</button>
          </div>
        </form>
      </div>

      <hr />

      <section>
        <h2>Recently updated</h2>
        <div id="recent-list" class="mt-20"></div>
      </section>

      <hr />

      <section>
        <h2>All ingredients</h2>

        <div class="mt-20">
          <label for="search-input">Filter</label>
          <input
            id="search-input"
            type="text"
            placeholder="Search by name, category, supplier, invoice..."
          />
        </div>

        <table>
          <thead>
            <tr>
              <th>Ingredient</th>
              <th>Category</th>
              <th>Sub-type</th>
              <th>Supplier</th>
              <th>Invoice #</th>
              <th>Unit</th>
              <th>Latest price</th>
              <th>Last updated</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="purchase-table"></tbody>
        </table>
      </section>
    </main>
  </div>

  <script src="assets/app.js"></script>
</body>
</html>
